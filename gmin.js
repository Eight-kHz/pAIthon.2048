const _0x43d38d=_0x3290;(function(_0x3e5f7f,_0xcabcb5){const _0x346329=_0x3290,_0x3b6e2b=_0x3e5f7f();while(!![]){try{const _0x156e4e=parseInt(_0x346329(0xed))/0x1+-parseInt(_0x346329(0xe5))/0x2*(-parseInt(_0x346329(0xea))/0x3)+-parseInt(_0x346329(0xdc))/0x4+-parseInt(_0x346329(0xc0))/0x5*(-parseInt(_0x346329(0xbc))/0x6)+parseInt(_0x346329(0xdd))/0x7*(parseInt(_0x346329(0x103))/0x8)+-parseInt(_0x346329(0xb5))/0x9*(-parseInt(_0x346329(0xd3))/0xa)+-parseInt(_0x346329(0xb2))/0xb;if(_0x156e4e===_0xcabcb5)break;else _0x3b6e2b['push'](_0x3b6e2b['shift']());}catch(_0x3f7161){_0x3b6e2b['push'](_0x3b6e2b['shift']());}}}(_0x43bc,0x942c4));const gridSize=0x4;let isDragging=![];const minSwipeDist=0xa;let score=0x0,record=0x0,user='None',m_id='None',payload={},reached=![],touchStartX=0x0,touchStartY=0x0,mouseStartX=0x0,mouseStartY=0x0;function getParamsFromURL(){const _0x35dd98=_0x3290;try{const _0x54c33b=new URLSearchParams(window[_0x35dd98(0x105)][_0x35dd98(0xe4)])[_0x35dd98(0xfe)]('r');if(!_0x54c33b)throw new Error(_0x35dd98(0x10f));const {u:_0xb33e46,m:_0x24d36d,r:_0x52e9b8}=JSON[_0x35dd98(0xeb)](atob(_0x54c33b));user=_0xb33e46??user,m_id=_0x24d36d??m_id,record=_0x52e9b8??record;}catch(_0x32b445){console[_0x35dd98(0xb3)](_0x35dd98(0xf3),_0x32b445[_0x35dd98(0xdb)]);}return{'user':user,'m_id':m_id,'record':record,'payload':{'type':_0x35dd98(0xe6),'score':record,'user':user,'m_id':m_id}};}function init(){const _0x931fb0=_0x3290;document[_0x931fb0(0xd7)](_0x931fb0(0x107))[_0x931fb0(0xad)]['display']=_0x931fb0(0xae),grid=Array(gridSize*gridSize)[_0x931fb0(0xbd)](0x0),score=0x0,reached=![],document[_0x931fb0(0xcc)]('h1')[_0x931fb0(0xad)]=_0x931fb0(0xb0),updateScore(),addRandomTile(),addRandomTile(),drawGrid();}function _0x3290(_0x5f0b20,_0x56963b){const _0x43bceb=_0x43bc();return _0x3290=function(_0x329083,_0x334112){_0x329083=_0x329083-0xa6;let _0x55d598=_0x43bceb[_0x329083];return _0x55d598;},_0x3290(_0x5f0b20,_0x56963b);}function _0x43bc(){const _0x1aea6d=['getElementById','clientX','⚠️\x20Не\x20удалось\x20сохранить\x20рекорд','touchend','message','595320myPEwa','42TbDRtM','opacity','clientY','m_id','success','#fff','Server\x20response:','search','137498ETNNvn','2048','\x27\x0am_id:\x20\x27','click','translate(-50%,\x20-60%)\x20scale(0.9)','21kytGLC','parse','None','650207vcOPWb','load','tile','block','#edc53f','push','URL\x20data\x20missing\x20or\x20invalid:','⚠️\x20Рекорд\x20не\x20сохранён.<br>Зайди\x20из\x20Телеграм!','then','POST','flat','transform','.record','error','flex','Поздравляю,\x20ты\x20прошел\x20игру!','random','get','#edcc61','#f59563','color','addEventListener','759152uXwoFp','translate(-50%,\x20-60%)','location','game-container','over-overlay','\x27\x0auser:\x20\x27','payload','background','touches','left','div','log','No\x20data\x20in\x20URL','record','length','score','type','textContent','https://mygame2048.loca.lt/game_score','display','style','none','popup-message','\x0a\x20\x20\x20\x20\x20margin-bottom:\x200.2rem;\x0a\x20\x20\x20\x20\x20font-size:\x201.8rem;\x0a\x20\x20\x20\x20\x20color:\x20#fff;','hsl(','23555983cgUpWO','warn','scrollWidth','481572eHkUxA','key','#edcf72','#ede0c8','#3a3a3a','map','application/json','573498aCbbiT','fill','✅\x20Рекорд\x20сохранён!','abs','15kHPLwR','#f65e3b','user','right','floor','className','innerHTML','json','includes','down','changedTouches','forEach','querySelector','touchstart','mouseup','#f67c5f','fontSize','#edc22e','#eee4da','170dNJaBE','mousedown','stringify','mousemove'];_0x43bc=function(){return _0x1aea6d;};return _0x43bc();}function drawGrid(){const _0x4c75ec=_0x3290,_0x4394af=document[_0x4c75ec(0xd7)](_0x4c75ec(0x106));_0x4394af[_0x4c75ec(0xc6)]='',grid[_0x4c75ec(0xcb)](_0x236898=>{const _0x12f445=_0x4c75ec,_0x532ddf=document['createElement'](_0x12f445(0x10d));_0x532ddf[_0x12f445(0xc5)]=_0x12f445(0xef),_0x532ddf[_0x12f445(0xad)]['color']=_0x236898===0x2||_0x236898===0x4?'#333':_0x12f445(0xe2),_0x532ddf[_0x12f445(0xad)][_0x12f445(0x10a)]=_0x236898>0x0?getTileColor(_0x236898):_0x12f445(0xb9),_0x532ddf[_0x12f445(0xaa)]=_0x236898>0x0?_0x236898:'',_0x4394af['appendChild'](_0x532ddf);const _0x5a3927=_0x532ddf['textContent'][_0x12f445(0xa7)],_0x4f4db9=0x2,_0x5e8057=0.3,_0x4b0042=Math['max'](0.8,_0x4f4db9-(_0x5a3927-0x3)*_0x5e8057);_0x532ddf[_0x12f445(0xad)][_0x12f445(0xd0)]=_0x4b0042+'rem';});}function updateFontSize(){const _0x4f97e9=_0x3290;[_0x4f97e9(0xa8),'record'][_0x4f97e9(0xcb)](_0x5ae9f8=>{const _0x5e4975=_0x4f97e9,_0x2f0c6e=document[_0x5e4975(0xd7)](_0x5ae9f8);let _0x34bbbe=1.5;_0x2f0c6e[_0x5e4975(0xad)][_0x5e4975(0xd0)]=_0x34bbbe+'rem';while(_0x2f0c6e[_0x5e4975(0xb4)]>_0x2f0c6e['clientWidth']&&_0x34bbbe>0.5){_0x34bbbe-=0.05,_0x2f0c6e['style']['fontSize']=_0x34bbbe['toFixed'](0x2)+'rem';}});}function updateScore(){const _0x31f1e5=_0x3290,_0x3eb46b=document['getElementById'](_0x31f1e5(0xa8)),_0x4e34f4=document[_0x31f1e5(0xd7)](_0x31f1e5(0xa6));score>record&&(record=score),_0x3eb46b[_0x31f1e5(0xaa)]=score,_0x4e34f4[_0x31f1e5(0xaa)]=record,updateFontSize();}function getTileColor(_0x5b4ccb){const _0x5328be=_0x3290,_0x4b2d75={0x2:_0x5328be(0xd2),0x4:_0x5328be(0xb8),0x8:'#f2b179',0x10:_0x5328be(0x100),0x20:_0x5328be(0xcf),0x40:_0x5328be(0xc1),0x80:_0x5328be(0xb7),0x100:_0x5328be(0xff),0x200:'#edc850',0x400:_0x5328be(0xf1),0x800:_0x5328be(0xd1)};return _0x4b2d75[_0x5b4ccb]||_0x5328be(0xb1)+Math['log2'](_0x5b4ccb)*0x23%0x168+',\x2070%,\x2055%)';}function addRandomTile(){const _0x2125b5=_0x3290,_0x4c3f67=grid['reduce']((_0x14cf9e,_0x3614eb,_0x2a2d5d)=>_0x3614eb===0x0?[..._0x14cf9e,_0x2a2d5d]:_0x14cf9e,[]);if(!_0x4c3f67[_0x2125b5(0xa7)])return;const _0x35b2ae=_0x4c3f67[Math[_0x2125b5(0xc4)](Math[_0x2125b5(0xfd)]()*_0x4c3f67['length'])];grid[_0x35b2ae]=Math[_0x2125b5(0xfd)]()<0.9?0x2:0x4,checkReached();}function checkReached(){const _0x42df91=_0x3290;if(!reached){if(grid[_0x42df91(0xc8)](0x800)){reached=!![];const _0xfc7a53=document[_0x42df91(0xd7)]('congrat-popup');_0xfc7a53[_0x42df91(0xaa)]=_0x42df91(0xfc),_0xfc7a53[_0x42df91(0xad)][_0x42df91(0xac)]=_0x42df91(0xfb),_0xfc7a53[_0x42df91(0xad)]['opacity']='0',_0xfc7a53['style'][_0x42df91(0xf8)]='translate(-50%,\x20-60%)\x20scale(0.9)',setTimeout(()=>{const _0x3b229e=_0x42df91;_0xfc7a53[_0x3b229e(0xad)][_0x3b229e(0xde)]='1',_0xfc7a53[_0x3b229e(0xad)][_0x3b229e(0xf8)]='translate(-50%,\x20-50%)\x20scale(1)';},0xa),setTimeout(()=>{const _0x5ac772=_0x42df91;_0xfc7a53['style'][_0x5ac772(0xde)]='0',_0xfc7a53[_0x5ac772(0xad)][_0x5ac772(0xf8)]=_0x5ac772(0xe9),setTimeout(()=>{const _0x4ac382=_0x5ac772;_0xfc7a53['style'][_0x4ac382(0xac)]=_0x4ac382(0xae);},0x12c);},0xbb8),document['querySelector']('h1')[_0x42df91(0xad)]='\x0a\x20\x20\x20\x09\x09\x09\x20\x20margin-bottom:\x200.3rem;\x0a\x20\x20\x20\x09\x09\x09\x20\x20font-size:\x201.9rem;\x0a\x20\x20\x20\x09\x09\x09\x20\x20font-family:\x20sans-serif;\x0a\x20\x20\x20\x09\x09\x09\x20\x20color:\x20#FFD700;\x0a\x20\x20\x20\x09\x09\x09\x20\x20text-shadow:\x0a\x20\x20\x20\x09\x09\x09\x090\x200\x205px\x20#8B7500,\x0a\x20\x20\x20\x09\x09\x09\x090\x200\x2010px\x20#DAA520,\x0a\x20\x20\x20\x09\x09\x09\x090\x200\x2015px\x20#FFD700,\x0a\x20\x20\x20\x09\x09\x09\x090\x200\x2025px\x20#FFEC8B;\x0a\x20\x20\x20\x09\x09\x09\x20\x20animation:\x20pulse\x202s\x20infinite;';const _0xbe171e=document['querySelector'](_0x42df91(0xf9));_0xbe171e&&(_0xbe171e[_0x42df91(0xad)][_0x42df91(0x101)]='#FFD700');}}}function move(_0x385bca){const _0xaf105a=_0x3290,_0x4a3888=[...grid],_0x510cdc=Array(gridSize)[_0xaf105a(0xbd)]()[_0xaf105a(0xba)](()=>Array(gridSize)[_0xaf105a(0xbd)](0x0));let _0x1badc1=![];for(let _0x2671d2=0x0;_0x2671d2<gridSize;_0x2671d2++){let _0x366131=[];for(let _0x348566=0x0;_0x348566<gridSize;_0x348566++){let _0x14f80b;if(_0x385bca===_0xaf105a(0x10c))_0x14f80b=grid[_0x2671d2*gridSize+_0x348566];if(_0x385bca==='right')_0x14f80b=grid[_0x2671d2*gridSize+(gridSize-0x1-_0x348566)];if(_0x385bca==='up')_0x14f80b=grid[_0x348566*gridSize+_0x2671d2];if(_0x385bca==='down')_0x14f80b=grid[(gridSize-0x1-_0x348566)*gridSize+_0x2671d2];if(_0x14f80b!==0x0)_0x366131[_0xaf105a(0xf2)](_0x14f80b);}const _0x2ab58b=[..._0x366131];_0x366131=mergeRow(_0x366131);while(_0x366131[_0xaf105a(0xa7)]<gridSize)_0x366131[_0xaf105a(0xf2)](0x0);for(let _0xf7e215=0x0;_0xf7e215<gridSize;_0xf7e215++){let _0x4888e4=_0x366131[_0xf7e215];if(_0x385bca===_0xaf105a(0x10c))_0x510cdc[_0x2671d2][_0xf7e215]=_0x4888e4;if(_0x385bca===_0xaf105a(0xc3))_0x510cdc[_0x2671d2][gridSize-0x1-_0xf7e215]=_0x4888e4;if(_0x385bca==='up')_0x510cdc[_0xf7e215][_0x2671d2]=_0x4888e4;if(_0x385bca==='down')_0x510cdc[gridSize-0x1-_0xf7e215][_0x2671d2]=_0x4888e4;}JSON['stringify'](_0x2ab58b)!==JSON['stringify'](_0x366131)&&(_0x1badc1=!![]);}const _0x3be03e=_0x510cdc[_0xaf105a(0xf7)](),_0x1e9757=JSON[_0xaf105a(0xd5)](_0x4a3888)!==JSON[_0xaf105a(0xd5)](_0x3be03e);_0x1e9757&&(grid=_0x3be03e,addRandomTile(),updateScore(),drawGrid(),isGameOver()&&(document[_0xaf105a(0xd7)]('over-overlay')['style']['display']=_0xaf105a(0xf0),sendScoreToBot()));}function mergeRow(_0x3f7f00){const _0x4e7166=_0x3290;let _0x51f396=[],_0x2b3a76=![];for(let _0x13b998=0x0;_0x13b998<_0x3f7f00['length'];_0x13b998++){if(_0x2b3a76){_0x2b3a76=![];continue;}_0x13b998<_0x3f7f00['length']-0x1&&_0x3f7f00[_0x13b998]===_0x3f7f00[_0x13b998+0x1]&&_0x3f7f00[_0x13b998]!==0x0?(_0x51f396[_0x4e7166(0xf2)](_0x3f7f00[_0x13b998]*0x2),score+=_0x3f7f00[_0x13b998]*0x2,_0x2b3a76=!![]):_0x51f396[_0x4e7166(0xf2)](_0x3f7f00[_0x13b998]);}return _0x51f396;}function isGameOver(){const _0x4b6d89=_0x3290;return!grid[_0x4b6d89(0xc8)](0x0)&&!canMerge();}function canMerge(){const _0x2680e2=_0x3290;for(let _0x285566=0x0;_0x285566<gridSize*gridSize;_0x285566++){const _0x470839=Math[_0x2680e2(0xc4)](_0x285566/gridSize),_0x39aa0a=_0x285566%gridSize,_0x5ec397=grid[_0x285566],_0x12bf73=_0x39aa0a<gridSize-0x1?grid[_0x285566+0x1]:null,_0x302e7d=_0x470839<gridSize-0x1?grid[_0x285566+gridSize]:null;if(_0x5ec397===_0x12bf73||_0x5ec397===_0x302e7d)return!![];}return![];}function sendScoreToBot(){const _0x1a2774=_0x3290;if(m_id===_0x1a2774(0xec)||user===_0x1a2774(0xec)){showPopup(_0x1a2774(0xf4));return;}payload[_0x1a2774(0xa8)]=record,fetch(_0x1a2774(0xab),{'method':_0x1a2774(0xf6),'headers':{'Content-Type':_0x1a2774(0xbb)},'body':JSON[_0x1a2774(0xd5)](payload),'mode':'cors'})['then'](_0x4a3e6f=>_0x4a3e6f[_0x1a2774(0xc7)]())[_0x1a2774(0xf5)](_0x5f2659=>{const _0x17191a=_0x1a2774;console['log'](_0x17191a(0xe3),_0x5f2659),showPopup(_0x5f2659[_0x17191a(0xe1)]?_0x17191a(0xbe):'⚠️\x20Ошибка\x20при\x20сохранении\x20рекорда');})['catch'](_0x3c5e93=>{const _0xac759d=_0x1a2774;console[_0xac759d(0xfa)]('Ошибка\x20при\x20отправке\x20рекорда:',_0x3c5e93),showPopup(_0xac759d(0xd9));});}function showPopup(_0x3bcb91){const _0x41e85d=_0x3290,_0xfc7568=document[_0x41e85d(0xd7)](_0x41e85d(0xaf));_0xfc7568[_0x41e85d(0xc6)]=_0x3bcb91,_0xfc7568['style'][_0x41e85d(0xac)]=_0x41e85d(0xfb),_0xfc7568['style'][_0x41e85d(0xde)]='0',_0xfc7568['style'][_0x41e85d(0xf8)]='translate(-50%,\x20-60%)',setTimeout(()=>{const _0x205681=_0x41e85d;_0xfc7568[_0x205681(0xad)]['opacity']='1',_0xfc7568['style'][_0x205681(0xf8)]='translate(-50%,\x20-50%)';},0xa),setTimeout(()=>{const _0x4f52a2=_0x41e85d;_0xfc7568[_0x4f52a2(0xad)]['opacity']='0',_0xfc7568[_0x4f52a2(0xad)][_0x4f52a2(0xf8)]=_0x4f52a2(0x104),setTimeout(()=>{const _0x404203=_0x4f52a2;_0xfc7568[_0x404203(0xad)][_0x404203(0xac)]=_0x404203(0xae);},0x12c);},0x9c4);}window[_0x43d38d(0x102)]('keydown',_0x4e3b12=>{const _0x177020=_0x43d38d,_0x27aed5=_0x4e3b12[_0x177020(0xb6)],_0x20bf7d=_0x27aed5['toLowerCase'](),_0x10643f={'ArrowLeft':_0x177020(0x10c),'ArrowRight':'right','ArrowUp':'up','ArrowDown':'down','a':_0x177020(0x10c),'d':_0x177020(0xc3),'w':'up','s':_0x177020(0xc9),'ф':_0x177020(0x10c),'в':_0x177020(0xc3),'ц':'up','ы':'down'};if(_0x10643f[_0x27aed5])move(_0x10643f[_0x27aed5]);else _0x10643f[_0x20bf7d]&&move(_0x10643f[_0x20bf7d]);}),window['addEventListener'](_0x43d38d(0xcd),_0x492038=>{const _0x58a693=_0x43d38d,_0x19a01e=_0x492038[_0x58a693(0x10b)][0x0];touchStartX=_0x19a01e['clientX'],touchStartY=_0x19a01e[_0x58a693(0xdf)];}),window[_0x43d38d(0x102)](_0x43d38d(0xda),_0x311f4c=>{const _0x19b234=_0x43d38d,_0xda7f52=_0x311f4c[_0x19b234(0xca)][0x0],_0x3706bf=_0xda7f52['clientX']-touchStartX,_0x1cd13d=_0xda7f52[_0x19b234(0xdf)]-touchStartY;if(Math['abs'](_0x3706bf)<minSwipeDist&&Math[_0x19b234(0xbf)](_0x1cd13d)<minSwipeDist)return;Math[_0x19b234(0xbf)](_0x3706bf)>Math[_0x19b234(0xbf)](_0x1cd13d)?move(_0x3706bf>0x0?'right':_0x19b234(0x10c)):move(_0x1cd13d>0x0?_0x19b234(0xc9):'up');}),window[_0x43d38d(0x102)](_0x43d38d(0xd6),_0x3f2ada=>{const _0x1a0259=_0x43d38d;if(isDragging)return;const _0x324f40=_0x3f2ada[_0x1a0259(0xd8)]-mouseStartX,_0x2bdb55=_0x3f2ada[_0x1a0259(0xdf)]-mouseStartY;(Math[_0x1a0259(0xbf)](_0x324f40)>minSwipeDist||Math[_0x1a0259(0xbf)](_0x2bdb55)>minSwipeDist)&&(isDragging=!![]);}),window[_0x43d38d(0x102)](_0x43d38d(0xce),_0x48c638=>{const _0x5ba5f2=_0x43d38d;if(!isDragging)return;const _0x1ede04=_0x48c638[_0x5ba5f2(0xd8)]-mouseStartX,_0x30a7ab=_0x48c638[_0x5ba5f2(0xdf)]-mouseStartY;if(Math['abs'](_0x1ede04)<minSwipeDist&&Math[_0x5ba5f2(0xbf)](_0x30a7ab)<minSwipeDist)return;Math[_0x5ba5f2(0xbf)](_0x1ede04)>Math[_0x5ba5f2(0xbf)](_0x30a7ab)?move(_0x1ede04>0x0?_0x5ba5f2(0xc3):'left'):move(_0x30a7ab>0x0?'down':'up'),isDragging=![];}),window[_0x43d38d(0x102)](_0x43d38d(0xd4),_0x39e57e=>{const _0x1c77b7=_0x43d38d;mouseStartX=_0x39e57e[_0x1c77b7(0xd8)],mouseStartY=_0x39e57e[_0x1c77b7(0xdf)],isDragging=![];}),window[_0x43d38d(0x102)](_0x43d38d(0xee),()=>{const _0x1e9e5f=_0x43d38d,_0x541782=getParamsFromURL();user=_0x541782['user'],m_id=_0x541782[_0x1e9e5f(0xe0)],record=_0x541782['record'],payload=_0x541782[_0x1e9e5f(0x109)],init(),updateFontSize(),record>0x0&&(document['getElementById']('record')[_0x1e9e5f(0xaa)]=record),console[_0x1e9e5f(0x10e)]('User\x20login:\x0atype:\x20\x27'+payload[_0x1e9e5f(0xa9)]+_0x1e9e5f(0x108)+payload[_0x1e9e5f(0xc2)]+_0x1e9e5f(0xe7)+payload['m_id']+'\x27'),document[_0x1e9e5f(0xcc)]('.restart-button')[_0x1e9e5f(0x102)](_0x1e9e5f(0xe8),init),document['getElementById'](_0x1e9e5f(0x107))['addEventListener'](_0x1e9e5f(0xe8),()=>{const _0xe3274a=_0x1e9e5f;document['getElementById'](_0xe3274a(0x107))[_0xe3274a(0xad)]['display']=_0xe3274a(0xae),init();});});
